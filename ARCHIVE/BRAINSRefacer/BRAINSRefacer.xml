<?xml version="1.0" encoding="utf-8"?>
<executable>
  <category>Utilities.BRAINS</category>
  <title>BRAINSRefacer</title>
  <description>Deidentify head images without destroying useful facial information</description>
  <contributor>
    Alexander Leinoff (alexander-leinoff -at- uiowa.edu), Jeffrey Obadal (jeffrey-obadal -at- uiowa.edu) </contributor>
  <acknowledgements>
    <![CDATA[Hans Johnson(1,2,3); Alexander Leinoff(3); Yue Pan(3); Wei Shao(3); Jeffrey Obadal(3)  1=University of Iowa Department of Psychiatry, 2=University of Iowa Department of Biomedical Engineering, 3=University of Iowa Department of Electrical and Computer Engineering]]>
  </acknowledgements>
  <version>4.8.0</version>
  <documentation-url></documentation-url>
  <license>https://www.nitrc.org/svn/brains/BuildScripts/trunk/License.txt</license>
  <parameters>
    <label>Inputs</label>
    <description>Input parameters</description>
    <image>
      <label>Input Volume</label>
      <name>inputImage</name>
      <channel>input</channel>
      <longflag>inputImage</longflag>
      <description>Input Image of a head</description>
      <default>inputImage.nii.gz</default>
    </image>
    <image>
       <label>LabelMap</label>
       <name>labelmap</name>
       <channel>input</channel>
       <longflag>labelmap</longflag>
       <description>A Label Map for the head</description>
       <default>inputLabelMap.nii.gz</default>
    </image>
  <file fileExtensions=".fcsv">
     <label>Landmarks File</label>
     <channel>input</channel>
     <longflag>landmarks</longflag>
     <description>The landmarks file</description>
     <default>landmarks.fcsv</default>
  </file>
  <file>
    <label>bSpline Transform file name</label>
    <name>bSplineFileName</name>
    <channel>output</channel>
    <longflag>bSplineFileName</longflag>
    <description>A name for the Displaement Field image generated by the bSpline Transform</description>
    <default>bSplineFile.h5</default>
  </file>
    <file>
      <label>premade BSpline</label>
      <name>previousBSplineFileName</name>
      <channel>input</channel>
      <longflag>--previousBSpline</longflag>
      <description>Re use a previously generated BSpline instead of generating a new random one.</description>
      <default>reusedBSplineFileName.h5</default>
    </file>
  </parameters>
  <parameters advanced="true">
    <label>Outputs of intermediary steps</label>
    <description>Output parameters for intermediary steps. This is so we can see what is going on as the program progresses.</description>
    <image>
      <label>OutputMask name</label>
      <name>outputMask</name>
      <channel>output</channel>
      <longflag>outputMask</longflag>
      <description>A name for the output mask derived from the Atlas Label map</description>
      <default>outputMask.nii.gz</default>
    </image>
    <image>
      <label>Distance Map file name</label>
      <name>distanceMapFileName</name>
      <channel>output</channel>
      <longflag>distanceMapFileName</longflag>
      <description>A name for the output mask derived from the Atlas Label map</description>
      <default>distanceMapFileName.nii.gz</default>
    </image>
    <file>
      <label>final Transform file name</label>
      <name>finalTransformFileName</name>
      <channel>output</channel>
      <longflag>finalTransformFileName</longflag>
      <description>A name for the Displaement Field image generated by the final Transform</description>
    <default>finalTransformFile.h5</default>
    </file>
    <image type = "vector">
      <label>bSpline and distance Displacement Map file name</label>
      <name>smoothDisplacementName</name>
      <channel>output</channel>
      <longflag>smoothDisplacementName</longflag>
      <description>A name for the Displaement Field combined with the distance map</description>
      <default>smoothDisplacementName.nii.gz</default>
    </image>
    <image>
      <label>diffImage output</label>
      <name>diffImageName</name>
      <channel>output</channel>
      <longflag>diffImageName</longflag>
      <description>difference of subject image and transformed image</description>
      <default>diffImageName.nii.gz</default>
    </image>
  </parameters>
  <parameters>
    <label>Main Output</label>
    <description>Main Output (deformed subject) Parameters</description>
    <image>
      <label>DeformedImage name</label>
      <name>deformedImageName</name>
      <channel>output</channel>
      <longflag>deformedImageName</longflag>
      <description>A name for the output of the deformed Image</description>
      <default>deformedImageName.nii.gz</default>
    </image>
  </parameters>
  <parameters advanced="true">
    <label>Control Options</label>
    <description>These parameters control the various options</description>
    <integer>
      <label>Max Random</label>
      <name>maxRandom</name>
      <channel>input</channel>
      <longflag>maxRandom</longflag>
      <description>The maximum range of randomness of the BSPline</description>
      <default>5</default>
      <constraints>
        <maximum>10</maximum>
        <minimum>-10</minimum>
        <step>1</step>
      </constraints>
    </integer>
    <integer>
      <label>Min Random</label>
      <name>minRandom</name>
      <channel>input</channel>
      <longflag>minRandom</longflag>
      <description>The minimum range of randomness of the BSPline</description>
      <default>-5</default>
      <constraints>
        <maximum>10</maximum>
        <minimum>-10</minimum>
        <step>1</step>
      </constraints>
    </integer>
    <double>
      <label>Distance Map Scale</label>
      <name>scaleDistanceMap</name>
      <channel>input</channel>
      <longflag>scaleDistanceMap</longflag>
      <description>The amount the Distance Map is scaled by</description>
      <default>0.05</default>
      <constraints>
        <maximum>1</maximum>
        <minimum>0.01</minimum>
        <step>0.01</step>
      </constraints>
    </double>
    <integer>
      <label>BSpline Control Points</label>
      <name>bsplineControlPoints</name>
      <channel>input</channel>
      <longflag>bsplineControlPoints</longflag>
      <description>The number of bspline control points in each direction</description>
      <default>25</default>
      <constraints>
        <!-- what should the contraits actually be??
             what would make sense and why?? -->
        <minimum>1</minimum>
        <maximum>50</maximum>
        <step>1</step>
      </constraints>
    </integer>
  </parameters>
  <parameters>
    <label>Some options</label>
    <boolean>
      <name>labelmapSwitch</name>
      <label>Use labelmap-based mask</label>
      <longflag>--labelmapMask</longflag>
      <default>false</default>
    </boolean>

    <boolean>
      <name>verbose_Refacer</name>
      <label> Verbose output</label>
      <longflag>--verbose</longflag>
      <default>false</default>
    </boolean>
    <boolean>
      <label>Debug flag</label>
      <name>debug_Refacer</name>
      <longflag>--debug</longflag>
      <default>false</default>
    </boolean>
    <boolean>
      <label>save transform flag</label>
      <name>saveTransform</name>
      <longflag>--saveTransform</longflag>
      <default>false</default>
    </boolean>
  </parameters>
  <parameters>
    <label> Preset face type parameter options </label>
    <boolean>
      <name>reusebspline</name>
      <label>ReUse a previously generated BSpline</label>
      <description>This will generate the same deformation as a previous one.</description>
      <longflag>--reusebspline</longflag>
      <default>false</default>
    </boolean>
    <boolean>
     <name>babyface</name>
      <label>BabyFace</label>
      <longflag>babyface</longflag>
      <default>false</default>
      <description>Produces a Squished, baby like face</description>
    </boolean>
    <boolean>
      <name>birdface</name>
      <label>BirdFace</label>
      <longflag>birdface</longflag>
      <default>false</default>
      <description>Typically produces a narrow, birdlike face with an extended nose</description>
    </boolean>
    <boolean>
      <name>defaultface</name>
      <label>DefaultFace</label>
      <longflag>defaultface</longflag>
      <description>Uses the default parameters to produce a randomly deformed face</description>
      <default>false</default>
    </boolean>
    <boolean>
      <name>setMersenneSeed</name>
      <label>Set Mersenne Seed</label>
      <longflag>setMersenneSeed</longflag>
      <description>Use a predetermined value for the mersenne seed</description>
      <default>false</default>
    </boolean>
    <integer>
      <name>mersenneSeed</name>
      <label>The Mersenne Seed></label>
      <longflag>mersenneSeed</longflag>
      <description>The predetermined value for the Mersenne seed</description>
    </integer>
    <boolean>
      <name>printMersenneSeed</name>
      <label>Print the Mersenne Seed</label>
      <longflag>printMersenneSeed</longflag>
      <description>You can print the Mersenne Seed in the console to use it again later</description>
      <default>false</default>
    </boolean>
  </parameters>
</executable>
